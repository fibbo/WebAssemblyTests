<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <link rel="stylesheet" href="../css/styles.css">

  <script>
    var Module = Module !== undefined ? Module : {};
    Module['onRuntimeInitialized'] = () =>
    {
        console.log('onruntimeinitialized');
        Module.loadLib();

    }
    

    Module.loadedSideModule = () => {
      Module.call_new();
      Module.lib_functions();
      Module.call_side_new();
    }

  </script>
  <script type="text/javascript" src="output/main.js"></script>

</head>
<body>
    <h1>Calling Library Functions (e.g. new/malloc/free) in Side Module </h1>

    <ol>
      <li class="works">main wasm/js size with O2 and EXPORT_ALL=1: js: 1812 KB, wasm: 1083 KB -> Total size = 2895 KB</li>
      <li class="fails">main wasm/js size with O2 and EXPORT_ALL=0: js: 827 KB, wasm: 554 KB -> Total size =  1381 KB</li>
    </ol>

    <h2>Findings</h2>
    C library functions seem to work without exporting all functions from the main module. However using new in the side module fails.
    <br><br><a href="../index.html">back to index</a>
  </body>
</html>